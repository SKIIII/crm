var x=Object.defineProperty,A=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var I=(o,e,t)=>e in o?x(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,j=(o,e)=>{for(var t in e||(e={}))$.call(e,t)&&I(o,t,e[t]);if(V)for(var t of V(e))B.call(e,t)&&I(o,t,e[t]);return o},k=(o,e)=>A(o,R(e));import{_ as N,u as S,b as z,h as y}from"./index.8857c13e.js";import{a2 as q,$ as w,a3 as E,u as L,r as M,b as g,o as D,a4 as G,t as O,d as c,e as T,f as H,j as s,w as l,_ as p,k as J,i as K}from"./vendor.bcf7419b.js";import"./wangEditor.71934d25.js";const P={name:"AddCustomer",setup(){const{proxy:o}=q();console.log("proxy",o);const e=w(null),t=w(null),f=E(),v=L(),{id:d}=f.query,a=M({uploadImgServer:S,token:z("token")||"",id:d,defaultCate:"",goodForm:{name:"",phonenumber:"",address:""},rules:{name:[{required:"true",message:"\u8BF7\u586B\u5199\u5BA2\u6237\u59D3\u540D",trigger:["change"]}]},categoryId:"",category:{lazy:!0,lazyLoad(r,u){const{level:i=0,value:n}=r;g.get("/categories",{params:{pageNumber:1,pageSize:1e3,categoryLevel:i+1,parentId:n||0}}).then(F=>{const U=F.list.map(C=>({value:C.categoryId,label:C.categoryName,leaf:i>1}));u(U)})}}});D(()=>{d&&g.post("/mgr/customers",{action:"get_customer",id:d}).then(r=>{a.goodForm={name:r.name,phonenumber:r.phonenumber,address:r.address}})}),G(()=>{});const m=()=>{t.value.validate(r=>{if(r){let u=g.post,i="add_customer",n={name:a.goodForm.name,phonenumber:a.goodForm.phonenumber,address:a.goodForm.address};if(y(n.name)||y(n.phonenumber)||y(n.address)){p.error("\u4E0D\u8981\u8F93\u5165\u8868\u60C5\u5305\uFF0C\u518D\u8F93\u5165\u5C31\u6253\u6B7B\u4F60\u4E2A\u9F9F\u5B59\u513F~");return}if(n.name.length>200){p.error("\u5BA2\u6237\u59D3\u540D\u4E0D\u80FD\u8D85\u8FC7200\u4E2A\u5B57\u7B26");return}if(n.phonenumber.length>20){p.error("\u624B\u673A\u53F7\u4E0D\u80FD\u8D85\u8FC720\u4E2A\u5B57\u7B26");return}if(n.address.length>200){p.error("\u5730\u5740\u4E0D\u80FD\u8D85\u8FC7200\u4E2A\u5B57\u7B26");return}console.log("params",n),d&&(n.id=d,u=g.put,i="modify_customer"),u("/mgr/customers",{action:i,data:n}).then(F=>{p.success(d?"\u4FEE\u6539\u6210\u529F":"\u6DFB\u52A0\u6210\u529F"),v.push({path:"/customer"})})}})},_=r=>{const u=r.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(u))return p.error("\u8BF7\u4E0A\u4F20 jpg\u3001jpeg\u3001png \u683C\u5F0F\u7684\u56FE\u7247"),!1},h=r=>{a.goodForm.goodsCoverImg=r.data||""},b=r=>{a.categoryId=r[2]||0};return k(j({},O(a)),{goodRef:t,submitAdd:m,handleBeforeUpload:_,handleUrlSuccess:h,editor:e,handleChangeCate:b})}},Q={class:"add"};function W(o,e,t,f,v,d){const a=c("el-input"),m=c("el-form-item"),_=c("el-button"),h=c("el-form"),b=c("el-card");return T(),H("div",Q,[s(b,{class:"add-container"},{default:l(()=>[s(h,{model:o.goodForm,rules:o.rules,ref:"goodRef","label-width":"100px",class:"goodForm"},{default:l(()=>[s(m,{label:"\u5BA2\u6237\u59D3\u540D",prop:"name"},{default:l(()=>[s(a,{style:{width:"300px"},modelValue:o.goodForm.name,"onUpdate:modelValue":e[0]||(e[0]=r=>o.goodForm.name=r),placeholder:"\u8BF7\u8F93\u5165\u5BA2\u6237\u59D3\u540D"},null,8,["modelValue"])]),_:1}),s(m,{label:"\u624B\u673A\u53F7\u7801",prop:"phonenumber"},{default:l(()=>[s(a,{type:"number",style:{width:"300px"},modelValue:o.goodForm.phonenumber,"onUpdate:modelValue":e[1]||(e[1]=r=>o.goodForm.phonenumber=r),placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7\u7801"},null,8,["modelValue"])]),_:1}),s(m,{label:"\u5730\u5740",prop:"address"},{default:l(()=>[s(a,{style:{width:"300px"},modelValue:o.goodForm.address,"onUpdate:modelValue":e[2]||(e[2]=r=>o.goodForm.address=r),placeholder:"\u8BF7\u8F93\u5165\u5730\u5740"},null,8,["modelValue"])]),_:1}),s(m,null,{default:l(()=>[s(_,{type:"primary",onClick:e[3]||(e[3]=r=>f.submitAdd())},{default:l(()=>[J(K(o.id?"\u7ACB\u5373\u4FEE\u6539":"\u7ACB\u5373\u521B\u5EFA"),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})])}var re=N(P,[["render",W],["__scopeId","data-v-7fc34856"]]);export{re as default};
