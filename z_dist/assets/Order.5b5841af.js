var N=Object.defineProperty,V=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var k=(t,e,a)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,x=(t,e)=>{for(var a in e||(e={}))B.call(e,a)&&k(t,a,e[a]);if(C)for(var a of C(e))I.call(e,a)&&k(t,a,e[a]);return t},z=(t,e)=>V(t,T(e));import{_ as $}from"./index.8857c13e.js";import{u as M,r as R,o as j,b as m,t as q,d as p,a6 as A,e as b,n as v,w as i,_ as d,g as D,j as o,h as S,a8 as F,i as L,k as P}from"./vendor.bcf7419b.js";const U={name:"Order",setup(){const t=M(),e=R({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,orderNo:"",orderStatus:"",options:[{value:"",label:"\u5168\u90E8"},{value:0,label:"\u5F85\u652F\u4ED8"},{value:1,label:"\u5DF2\u652F\u4ED8"},{value:2,label:"\u914D\u8D27\u5B8C\u6210"},{value:3,label:"\u51FA\u5E93\u6210\u529F"},{value:4,label:"\u4EA4\u6613\u6210\u529F"},{value:-1,label:"\u624B\u52A8\u5173\u95ED"},{value:-2,label:"\u8D85\u65F6\u5173\u95ED"},{value:-3,label:"\u5546\u5BB6\u5173\u95ED"}]});j(()=>{a()});const a=()=>{e.loading=!0,m.get("/mgr/orders",{params:{action:"list_order",page:e.currentPage,limit:e.pageSize}}).then(l=>{e.tableData=l.list,e.total=l.totalCount,e.currentPage=l.currPage,e.loading=!1})},u=()=>{e.currentPage=1,a()},w=l=>{e.multipleSelection=l},y=l=>{e.currentPage=l,a()},_=()=>{t.push({path:"/add_order"})},g=(l,n)=>{m.post("/mgr/orders",{action:"del_order",ids:l?[l]:[]}).then(()=>{d.success("\u5220\u9664\u6210\u529F"),a()})},r=l=>{console.log("id",l);let n;if(l)n=[l];else{if(!e.multipleSelection.length){console.log("state.multipleSelection",e.multipleSelection.length),d.error("\u8BF7\u9009\u62E9\u9879");return}n=e.multipleSelection.map(c=>c.orderId)}m.put("/orders/checkDone",{ids:n}).then(()=>{d.success("\u914D\u8D27\u6210\u529F"),a()})},h=l=>{let n;if(l)n=[l];else{if(!e.multipleSelection.length){d.error("\u8BF7\u9009\u62E9\u9879");return}n=e.multipleSelection.map(c=>c.orderId)}m.put("/orders/checkOut",{ids:n}).then(()=>{d.success("\u51FA\u5E93\u6210\u529F"),a()})},f=l=>{let n;if(l)n=[l];else{if(!e.multipleSelection.length){d.error("\u8BF7\u9009\u62E9\u9879");return}n=e.multipleSelection.map(c=>c.orderId)}m.put("/orders/close",{ids:n}).then(()=>{d.success("\u5173\u95ED\u6210\u529F"),a()})};return z(x({},q(e)),{handleSelectionChange:w,getOrderList:a,changePage:y,handleOption:u,handleConfig:r,handleSend:h,handleClose:f,handleAdd:_,handleDel:g})}},E={class:"header"},G=P("\u67E5\u8BE2"),H=P("\u5220\u9664");function J(t,e,a,u,w,y){const _=p("el-input"),g=p("el-button"),r=p("el-table-column"),h=p("el-image"),f=p("el-popconfirm"),l=p("el-table"),n=p("el-pagination"),c=p("el-card"),O=A("loading");return b(),v(c,{class:"order-container"},{header:i(()=>[D("div",E,[o(_,{style:{width:"200px","margin-right":"10px"},placeholder:"\u8BF7\u8F93\u5165\u8BA2\u5355\u53F7",modelValue:t.orderNo,"onUpdate:modelValue":e[0]||(e[0]=s=>t.orderNo=s),onChange:u.handleOption,size:"small",clearable:""},null,8,["modelValue","onChange"]),S(` <el-select @change="handleOption" v-model="orderStatus" size="small"\r
					style="width: 200px; margin-right: 10px">\r
					<el-option v-for="item in options" :key="item.value" :label="item.label" :value="item.value" />\r
				</el-select> `),o(g,{type:"primary",size:"small",icon:"el-icon-search",onClick:t.handleSelect},{default:i(()=>[G]),_:1},8,["onClick"])])]),default:i(()=>[F((b(),v(l,{data:t.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:u.handleSelectionChange},{default:i(()=>[o(r,{type:"selection",width:"55"}),o(r,{label:"\u521B\u5EFA\u65F6\u95F4",width:"100px"},{default:i(s=>[D("span",null,L(t.$filters.FormatDate(s.row.create_time)),1)]),_:1}),o(r,{prop:"customer__name",label:"\u5BA2\u6237"}),o(r,{prop:"product__name",label:"\u4EA7\u54C1"}),o(r,{label:"\u4EA7\u54C1\u56FE\u7247",width:"150px"},{default:i(s=>[(b(),v(h,{style:{width:"100px",height:"100px"},key:s.row.id,src:t.$filters.prefix(s.row.product__image),fit:"cover","preview-src-list":[t.$filters.prefix(s.row.product__image)],"initial-index":s.row.id},null,8,["src","preview-src-list","initial-index"]))]),_:1}),o(r,{prop:"product__spec",label:"\u5C3A\u5BF8\u89C4\u683C"}),o(r,{prop:"price",label:"\u4EF7\u683C"}),o(r,{prop:"num",label:"\u6570\u91CF"}),o(r,{prop:"money",label:"\u603B\u989D"}),S(` <el-table-column prop="orderStatus" label="\u8BA2\u5355\u72B6\u6001">\r
				<template #default="scope">\r
					<span>{{ $filters.orderMap(scope.row.orderStatus) }}</span>\r
				</template>\r
			</el-table-column>\r
			<el-table-column prop="payType" label="\u652F\u4ED8\u65B9\u5F0F">\r
				<template #default='scope'>\r
					<span v-if="scope.row.payType == 1">\u5FAE\u4FE1\u652F\u4ED8</span>\r
					<span v-else-if="scope.row.payType == 2">\u652F\u4ED8\u5B9D\u652F\u4ED8</span>\r
					<span v-else>\u672A\u652F\u4ED8</span>\r
				</template>\r
			</el-table-column> `),o(r,{prop:"sn",label:"\u8BA2\u5355\u53F7",width:"200"}),o(r,{label:"\u64CD\u4F5C",fixed:"right"},{default:i(s=>[o(f,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",cancelButtonText:"\u53D6\u6D88",confirmButtonText:"\u786E\u8BA4",onConfirm:K=>u.handleDel(s.row.id)},{reference:i(()=>[o(g,{size:"small",type:"danger",onClick:e[1]||(e[1]=()=>{})},{default:i(()=>[H]),_:1})]),_:2},1032,["onConfirm"]),S(` <router-link :to="{ path: '/order_detail', query: { id: scope.row.orderId }}"><el-button size="small">\u8BA2\u5355\u8BE6\u60C5</el-button></router-link> `)]),_:1})]),_:1},8,["data","onSelectionChange"])),[[O,t.loading]]),o(n,{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"current-page":t.currentPage,onCurrentChange:u.changePage},null,8,["total","page-size","current-page","onCurrentChange"])]),_:1})}var Y=$(U,[["render",J],["__scopeId","data-v-3c1ef684"]]);export{Y as default};
